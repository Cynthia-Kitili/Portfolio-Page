$(function(){$('[data-toggle="popover"]').popover();$("[placeholder]").placeholder();var d=$("#signup_form");var b=d.find(".submit");var c=$("input[name=entry]").val();var h=$(".copy-invitation");if(h.length>0){if(!SB.isSafari){h.removeClass("hideme")}}var j=$("#inviteForm");$.validator.addMethod("invitemail",function(m,i){return !this.optional(i)&&$.validator.methods.email.call(this,m?m.trim():"",i)},$.i18n.get("user.checkmail2"));$.validator.setDefaults({ignore:""});var l=jQuery.validator.format($("#template").val()?$("#template").val().trim():"");var e=1;function a(){$(l(e++)).appendTo("#inviteForm .itemlist");if($("#inviteForm .itemlist > div").length>=10){$("#inviteForm #add").hide()}}$("#add").on("click",a);$("#inviteForm").on("click","a.remove-item",function(i){$(this).parents(".col-md-12").remove();if($("#inviteForm .itemlist > div").length<10){$("#inviteForm #add").show()}i.preventDefault();i.stopPropagation()});j.validate({onfocusout:false,onkeyup:false,rules:captcha.getValidationRules(),errorPlacement:function(i,m){i.addClass("help-block");captcha.addErrorClass(m,i)},submitHandler:function(){var i={};var m=new Array();$("#inviteForm .itemlist input[type='text']").each(function(){var n=$(this).val()?$(this).val().trim():"";if(""!=n){m.push(n)}});i.emailset=m.join(",");i.recaptcha=captcha.getValue();SB.post3({url:"/invite_colleagues?entry=postattendee",data:i,success:function(n){if(n&&n.result){SB.showSuccessMsg($.i18n.get("user.sendmail"),null,null,true);$("#inviteForm .itemlist input[type='text']").val("");setTimeout(function(){window.location.reload()},3000)}else{$("#invite_error_msg").show().text(captcha.reCaptchaMode()?$.i18n.get("error.page.recaptcha"):$.i18n.get("error.page.captcha"));if(captcha){captcha.refresh()}}},error:function(p,n,o){if(o===1042){SB.alertWithOutTitle(n,null,true)}else{g(p,n,o)}},failure:function(n){}})}});function g(p,i,m){var n=d.find("span.has-error");if(p){b.removeBusy();if(!n.length){n=$("#error_msg");n.addClass("has-error help-block")}n.html(i).show();if(1015==m){var o=$("#signup_form_body #email").val().trim();n.html($.i18n.get("user.email.registered",o,o)).show()}else{n.html(i).show()}d.find(".form-group").addClass("has-error");d.find("#warn_img").removeClass("hideme");if(captcha){captcha.refresh()}}else{n.empty().hide();d.find(".form-group").removeClass("has-error")}}d.on("keydown",function(i){d.find("#warn_img").addClass("hideme")});$("#invite_form_body").on("click","a.copy-invitation",function(m){var i=new Clipboard(".copy-invitation");i.on("success",function(){SB.showSuccessMsg($.i18n.get("invite.copyinvite1"),null,null,true)});i.on("error",function(){SB.showSuccessMsg($.i18n.get("invite.copyinvite2"),null,null,true)})});d.validate({rules:{email:{required:true,email:true}},messages:{email:{required:$.i18n.get("invite.required.email"),email:$.i18n.get("invite.format.email")}},errorPlacement:function(i,m){i.addClass("help-block").insertAfter(b)},submitHandler:function(){var n="";if(typeof(zm4demandScript)!="undefined"&&zm4demandScript){n=zm4demandScript.getDemandTextSic(parseInt($("#primary_sic").val().trim()))}var m={primary_sic:n,demandbase_sid:$("#demandbase_sid").val(),company_name:$("#company_name").val(),industry:$("#industry").val(),sub_industry:$("#sub_industry").val(),employee_range:$("#employee_range").val(),revenue_range:$("#revenue_range").val(),street_address:$("#street_address").val(),zip:$("#zip").val(),country_name:$("#country_name").val(),state_name:$("#state_name").val(),data_source:$("#data_source").val(),marketing_alias:$("#marketing_alias").val(),web_site:$("#web_site").val(),hq_phone:$("#hq_phone").val(),email:$("#email").val()?$("#email").val().trim():""};var i=document.referrer;SB.post3({url:"/signup_checkemail",data:{email:$("#email").val()?$("#email").val().trim():""},success:function(o){if(typeof o.result==="string"){location.href=decodeURIComponent(o.result);return}confirmSignUp($("#email").val(),function(q,p){if(q){$.extend(m,{email:q,captcha:p})}SB.post3({url:"/signup?pre="+i+"&entry="+c,data:m,success:function(s){if(typeof s.result==="string"){location.href=decodeURIComponent(s.result)}else{$("#email").val("");var r=$.i18n.get("register.success",SB.htmlEncode(m.email));SB.showSuccessMsg(r,null,null,true)}},error:g,btnContainer:d,showBusy:true})})},error:g,btnContainer:d,showBusy:true});return false}});var f=$("#sms_form");var k=$("#sms_form_body");var b=f.find(".submit");$("#sms_form").on("click","a.reset_sms_form",function(){$(this).parents(".success").hide();$("#sms_form > #sms_form_body").show();$("#sms_form #message_to").val("").trigger("focus")});f.validate({rules:{message_to:{minlength:10,required:true,number:true,digits:true}},errorPlacement:function(i,m){i.addClass("help-block").insertAfter(b)},submitHandler:function(){SB.post3({url:"/mobile/sendtextlink?num="+$("#message_to").val().trim(),data:{phoneNumber:$("#message_to").val().trim()},success:function(i){if(i&&i.result){$("#sms_form > .success").show();$("#sms_form > #sms_form_body").hide()}},btnContainer:f,showBusy:true})}})});